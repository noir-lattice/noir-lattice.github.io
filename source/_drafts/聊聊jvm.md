---
title: 聊聊JVM
tags:
categories:
---

## Java Virtual Machine
对于java虚拟机咱们写是需要专门写一篇来做下知识梳理的，将从以下各点内容铺开叙述jvm的结构与机制：
  * 内存结构
  * Garbage Collection
  * JIT(Just in Time)
  * AOT(Ahead on Time)
  * ClassLoader

## 内存结构
对于一个虚拟机架构的语言引擎，在启动时已经按照一定的方式将内存分类分区进行了调整。而对于JVM来说，内存结构分为6块，其结构如下图：  
![内存结构](ms.png)  
包括公共共享的堆与方法区与线程内的程序计数器、虚拟机栈和本地方法栈  

### 程序计数器
程序计数器标记当前进程序进程执行字节码的地址，分支、循环、跳转、异常处理与线程恢复等功能都依赖其完成。注意区分该处的程序计数器与操作系统的进程内的计数器，该处的程序计数器供给java线程使用。而对于Native方法不由JVM托管，故执行Native方法不需要PC寄存器。

### 本地方法栈
为本地方法服务。需要理解的是，执行其实还是操作系统在执行，JVM的本地方法栈只对方法压栈与出栈。

### 虚拟机栈
FIFO的策咯用栈来表示再合适不过了，在计算机系统中常用入栈/出栈来实现方法的调用/返回。在JVM中，将方法的局部变量表、操作数栈、动态连接和方法的返回构造成一个栈帧，并对其调用进行不断的压栈与出栈操作。 

栈内与代码执行关系如下图：

帧栈内与代码执行关系如下图：

### 堆

### 方法区
属于共享内存区域，存储描述类信息、常量、静态变量和JIT后的代码。